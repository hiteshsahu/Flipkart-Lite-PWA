'use strict';

var _ava = require('ava');

var _ava2 = _interopRequireDefault(_ava);

var _core = require('@webpack-blocks/core');

var _index = require('../index');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const webpack = {
  DefinePlugin: function DefinePluginMock(definitions) {
    this.definitions = definitions;
  }
};

(0, _ava2.default)('defineConstants() creates a single DefinePlugin instance only', t => {
  const config = (0, _core.createConfig)({ webpack: webpack }, [(0, _index.defineConstants)({ a: 'a' }), (0, _index.defineConstants)({ b: 'b' })]);

  t.is(Object.keys(config.plugins).length, 1);
  t.deepEqual(Object.keys(config.plugins[0].definitions), ['a', 'b']);
});

(0, _ava2.default)('defineConstants() encodes the values', t => {
  const config = (0, _core.createConfig)({ webpack: webpack }, [(0, _index.defineConstants)({
    foo: 'foo',
    bar: {
      baz: 3
    }
  })]);

  t.is(Object.keys(config.plugins).length, 1);
  t.deepEqual(config.plugins[0].definitions, {
    foo: '"foo"',
    bar: '{\n  "baz": 3\n}'
  });
});
//# sourceMappingURL=defineConstants.test.js.map