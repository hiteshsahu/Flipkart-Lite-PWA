{"version":3,"sources":["../../src/__tests__/createConfig.test.js"],"names":["t","block1","distinct1","shared","block2","distinct2","block3","distinct3","resultingConfig","deepEqual","Object","assign","pre","spy","is","callCount","lastCall","args","length","context","post","true","called","calledBefore"],"mappings":"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","file":"createConfig.test.js","sourcesContent":["import test from 'ava'\nimport sinon from 'sinon'\nimport { createConfig } from '../index'\n\ntest('createConfig() invokes blocks (config setters)', (t) => {\n  const block1 = () => ({\n    distinct1: 'distinct1',\n    shared: 'shared1'\n  })\n  const block2 = () => ({\n    distinct2: 'distinct2',\n    shared: 'shared2'\n  })\n  const block3 = () => ({\n    distinct3: 'distinct3',\n    shared: 'shared3'\n  })\n\n  const resultingConfig = createConfig({}, [ block1, block2, block3 ])\n\n  t.deepEqual(resultingConfig, {\n    distinct1: 'distinct1',\n    distinct2: 'distinct2',\n    distinct3: 'distinct3',\n    shared: 'shared3'\n  })\n})\n\ntest('createConfig() invokes pre hooks', (t) => {\n  const block1 = Object.assign(() => ({}), {\n    pre: sinon.spy(() => {})\n  })\n  const block2 = Object.assign(() => ({}), {\n    pre: sinon.spy(() => {})\n  })\n  const block3 = Object.assign(() => ({}), {\n    pre: sinon.spy(() => {})\n  })\n\n  createConfig({}, [ block1, block2, block3 ])\n\n  t.is(block1.pre.callCount, 1)\n  t.is(block2.pre.callCount, 1)\n  t.is(block3.pre.callCount, 1)\n\n  t.is(block1.pre.lastCall.args.length, 1)\n  const context = block1.pre.lastCall.args[0]\n  t.is(typeof context, 'object')\n\n  t.is(block2.pre.lastCall.args.length, 1)\n  t.is(block2.pre.lastCall.args[0], context)\n\n  t.is(block3.pre.lastCall.args.length, 1)\n  t.is(block3.pre.lastCall.args[0], context)\n})\n\ntest('createConfig() invokes post hooks', (t) => {\n  const block1 = Object.assign(() => ({}), {\n    post: sinon.spy(() => ({\n      distinct1: 'distinct1',\n      shared: 'shared1'\n    }))\n  })\n  const block2 = Object.assign(() => ({}), {\n    post: sinon.spy(() => ({\n      distinct2: 'distinct2',\n      shared: 'shared2'\n    }))\n  })\n  const block3 = Object.assign(() => ({}), {\n    post: sinon.spy(() => ({\n      distinct3: 'distinct3',\n      shared: 'shared3'\n    }))\n  })\n\n  const resultingConfig = createConfig({}, [ block1, block2, block3 ])\n  t.deepEqual(resultingConfig, {\n    distinct1: 'distinct1',\n    distinct2: 'distinct2',\n    distinct3: 'distinct3',\n    shared: 'shared3'\n  })\n\n  t.is(block1.post.callCount, 1)\n  t.is(block2.post.callCount, 1)\n  t.is(block3.post.callCount, 1)\n\n  t.is(block1.post.lastCall.args.length, 2)\n  t.is(typeof block1.post.lastCall.args[0], 'object')\n  t.deepEqual(block1.post.lastCall.args[1], {})\n  const context = block1.post.lastCall.args[0]\n\n  t.deepEqual(block2.post.lastCall.args, [\n    context,\n    { distinct1: 'distinct1', shared: 'shared1' }\n  ])\n\n  t.deepEqual(block3.post.lastCall.args, [\n    context,\n    { distinct1: 'distinct1', distinct2: 'distinct2', shared: 'shared2' }\n  ])\n})\n\ntest('createConfig() invokes hooks and setters in the right order', (t) => {\n  const block1 = Object.assign(sinon.spy(() => ({})), {\n    pre: sinon.spy(() => {}),\n    post: sinon.spy(() => ({}))\n  })\n  const block2 = Object.assign(sinon.spy(() => ({})), {\n    pre: [ sinon.spy(() => {}), sinon.spy(() => {}) ],\n    post: [ sinon.spy(() => {}), sinon.spy(() => {}) ]\n  })\n  const block3 = Object.assign(sinon.spy(() => ({})), {\n    pre: sinon.spy(() => {}),\n    post: sinon.spy(() => ({}))\n  })\n\n  createConfig({}, [ block1, block2, block3 ])\n\n  t.true(block1.pre.called)\n  t.true(block1.pre.calledBefore(block2.pre[0]))\n  t.true(block2.pre[0].called)\n  t.true(block2.pre[0].calledBefore(block2.pre[1]))\n  t.true(block2.pre[1].called)\n  t.true(block2.pre[1].calledBefore(block3.pre))\n  t.true(block3.pre.called)\n  t.true(block3.pre.calledBefore(block1))\n\n  t.true(block1.called)\n  t.true(block1.calledBefore(block2))\n  t.true(block2.called)\n  t.true(block2.calledBefore(block3))\n  t.true(block3.called)\n  t.true(block3.calledBefore(block1.post))\n\n  t.true(block1.post.called)\n  t.true(block1.post.calledBefore(block2.post[0]))\n  t.true(block2.post[0].called)\n  t.true(block2.post[0].calledBefore(block2.post[1]))\n  t.true(block2.post[1].called)\n  t.true(block2.post[1].calledBefore(block3.post))\n  t.true(block3.post.called)\n})\n\ntest('createConfig() ignores duplicate hooks', (t) => {\n  const block1 = Object.assign(sinon.spy(() => ({})), {\n    pre: sinon.spy(() => {}),\n    post: sinon.spy(() => ({}))\n  })\n  const block2 = Object.assign(sinon.spy(() => ({})), {\n    pre: [ sinon.spy(() => {}), block1.pre ],\n    post: [ sinon.spy(() => {}), block1.post ]\n  })\n  const block3 = Object.assign(sinon.spy(() => ({})), {\n    pre: block1.pre,\n    post: block1.post\n  })\n\n  createConfig({}, [ block1, block2, block3 ])\n\n  t.is(block1.pre.callCount, 1)\n  t.is(block1.post.callCount, 1)\n\n  t.is(block2.pre[0].callCount, 1)\n  t.is(block2.post[0].callCount, 1)\n\n  // no need to test block3's pre/post hook spies or block2's 2nd hooks,\n  // since they equal block1's\n})\n"]}